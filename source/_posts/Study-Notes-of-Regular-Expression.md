---
title: Study Notes of Regular Expression
description: 正则表达式学习笔记
date: 2020-02-24 10:48:06
categories:
- Study Notes
- Regular Expression
tags:
---

<img src="https://blog.malwarebytes.com/wp-content/uploads/2018/08/regex_puzzle-900x506.jpg" width="100%"/>

<!-- more -->

## 教程

> [learn-regex | GitHub](https://github.com/ziishaned/learn-regex)

## 什么是正则表达式？

> {% label info@正则表达式 %}<mark>是</mark>一组由字母和符号组成的{% label info@特殊文本 %}，它可以<mark>用来</mark>从文本中找出满足你想要的格式的句子。

## 元字符

> 元字符<mark>不</mark>代表他们本身的字面意思，他们都有特殊的含义。

| 元字符 | 描述                                                         |
| ------ | ------------------------------------------------------------ |
| .      | 匹配{% label info@任意 %}{% label danger@单个 %}字符<mark>除了</mark>换行符。 |
| [ ]    | 字符集。匹配方括号内的任意字符。                             |
| [^ ]   | 否定的字符种类。匹配<mark>除了</mark>方括号里的任意字符      |
| *      | 匹配 <mark>>=0</mark> 个重复的在 `*` 号之前的字符。          |
| +      | 匹配 <mark>>=1</mark> 个重复的 `+` 号前的字符。              |
| ?      | 标记 `?` 之前的字符为<mark>可选</mark>.                      |
| {n,m}  | 匹配 num 个大括号之间的字符 (n <= num <= m).                 |
| (xyz)  | 字符集，匹配与 xyz <mark>完全相等</mark>的字符串.            |
| \|     | 或元字符，匹配符号{% label info@前 %}<mark>或</mark>{% label info@后 %}的字符. |
| \      | 转义字符，用于匹配一些<mark>保留字符</mark> `[ ] ( ) { } . * + ? ^ $ \ |` |
| ^      | 正则表达式的<mark>开始符号</mark>.                           |
| $      | 正则表达式的<mark>结束符号</mark>.                           |

### 元字符 `.` 

### 字符集 `[]`

方括号用来指定一个字符集。

1. 括号中的字符集<mark>不关心顺序</mark>。

   表达式`[Tt]he` 匹配 `the` 和 `The`

2. 方括号的点号<mark>就</mark>表示点号

   表达式 `ar[.]` 匹配 `ar.`字符串

#### 否定字符集

一般来说 `^` 表示一个字符串的开头，但当它用在方括号里面的开头时，它表示这个字符集是否定的。 例如，表达式 [`[^c]ar`](https://regex101.com/r/nNNlq3/1) 匹配一个后面跟着 `ar` 的除了 `c` 的任意字符。

### 重复次数

后面跟着元字符 `+`，`*` or `?` 的，用来指定匹配子模式的次数。 这些元字符在不同的情况下有着不同的含义。

#### 元字符 `*`

`*` 号匹配在 `*` 之前的字符出现 <mark>>=0</mark> 次。 例如，表达式 `a*` 匹配 0个或者多个以 a 开头的字符。表达式 [`[a-z]*`](https://regex101.com/r/7m8me5/1) 匹配所有以小写字母开头的字符串。

`*` 元字符和 `.` 元字符搭配可以匹配所有的字符(`.*`)。

`*` 和空格元字符 `\s` 连起来用，如表达式 [`\s*cat\s*`](https://regex101.com/r/gGrwuz/1) 匹配以 0个或多个空格开头，中间是 cat，并且以 0个或多个空格结尾的字符串。

#### 元字符 `+`

`+` 元字符匹配 `+` 号之前的字符出现 <mark>>=1</mark> 次。 例如表达式 [`c.+t`](https://regex101.com/r/Dzf9Aa/1) 匹配以字母 `c` 开头以 `t` 结尾，中间跟着至少一个字符的字符串。

#### 元字符 `?`

元字符 `?` 表示前面的字符为<mark>可选字符</mark>，即出现 0 次或 1 次。 例如，表达式 [`[T]?he`](https://regex101.com/r/kPpO2x/1) 匹配字符串 `he` 和 `The`。

### 元字符 `{}`

在正则表达式中 `{}` 是一个量词，常用来表示一个或一组字符可以重复出现的次数。 例如，表达式 [`[0-9]{2,3}`](https://regex101.com/r/juM86s/1) 匹配最少 2 位最多 3 位 0~9 的数字。

可以省略第二个参数。 例如，[`[0-9]{2,}`](https://regex101.com/r/Gdy4w5/1) 匹配至少两位 0~9 的数字。

如果逗号也省略掉，则表示重复固定的次数。 例如，[`[0-9]{3}`](https://regex101.com/r/Sivu30/1) 匹配 3 位 0~9 的数字

### 元字符 `()`

元字符 `()` 表示将括号内的子模式绑定为一个组，将这个组作为一个新的子模式进行匹配。

例如之前说的 `{}` 是用来表示前面一个字符出现指定次数。但如果在 `{}` 前用括号将一串字符括起来，则表示整个括号内的字符重复 N 次。例如，表达式 `(ab)*` 匹配连续出现 0 个或多个 `ab`。

还可以在 `()` 中用 `|` 表示或。例如，[`(c|g|p)ar`](https://regex101.com/r/tUxrBG/1) 匹配 `car` 或 `gar` 或 `par`.

### 元字符 `|`

元字符 `|` 表示或，用作判断条件。

例如 [`(T|t)he|car`](https://regex101.com/r/fBXyX0/1) 匹配 `(T|t)he` 或 `car`。

### 元字符 `\`

元字符 `\` 用于转义紧跟其后的字符。用于转义 `{ } [ ] / \ + * . $ ^ | ?` 这些特殊字符。如果想要匹配这些特殊字符则要在其前面加上反斜线 `\`。

例如 `.` 是用来匹配除换行符外的所有单个字符的。如果想要匹配句子中的 `.` 则要写成 `\.`。

例如 [`(f|c|m)at\.?`](https://regex101.com/r/DOc5Nu/1) 匹配以 `f` 或者 `c` 或者 `m` 开头，中间是 `mt`，后面有 0 个或者 1 个 `.`

### 锚点

正则表达式中，想要匹配指定开头或结尾的字符串就要使用到锚点。`^` 指定开头，`$` 指定结尾。

### 元字符 `^`

`^` 用来检查匹配的字符串是否在所匹配字符串的开头。

例如，在 `abc` 中使用表达式 `^a` 会得到结果 `a`。但如果使用 `^b` 将匹配不到任何结果。因为在字符串 `abc` 中并没有以 `b` 开头的字符串。

例如，[`^(T|t)he`](https://regex101.com/r/jXrKne/1) 匹配以 `The` 或 `the` 开头的字符串。

### 元字符 `$`

与 `^` 同理，元字符 `$` 用来检查匹配的字符串是否在所匹配字符串的结尾。

例如，[`(at\.)$`](https://regex101.com/r/t0AkOd/1) 匹配以 `at.` 结尾的字符串。

## 简写字符集

正则表达式提供一些常用的字符集简写。如下:

| 简写 | 描述                                                         |
| ---- | ------------------------------------------------------------ |
| .    | 除<mark>换</mark>行符外的所有单个字符                        |
| \w   | 匹配所有<mark>字母数字</mark>，等同于 `[a-zA-Z0-9_]`         |
| \W   | 匹配所有<mark>非字母数字</mark>，即符号，等同于： `[^\w]`    |
| \d   | 匹配<mark>数字</mark>： `[0-9]`                              |
| \D   | 匹配<mark>非数字</mark>： `[^\d]`                            |
| \s   | 匹配所有<mark>空格字符</mark>，等同于： `[\t\n\f\r\p{Z}]`    |
| \S   | 匹配所有<mark>非空格字符</mark>： `[^\s]`                    |
| \f   | 匹配一个<mark>换页符</mark>                                  |
| \n   | 匹配一个<mark>换行符</mark>                                  |
| \r   | 匹配一个<mark>回车符</mark>                                  |
| \t   | 匹配一个<mark>制表符</mark>                                  |
| \v   | 匹配一个<mark>垂直制表符</mark>                              |
| \p   | 匹配 CR/LF（等同于 `\r\n`），用来匹配 DOS 行<mark>终止符</mark> |

## 零宽度断言

零宽度断言用来指定一个<mark>位置(零宽度)</mark>，这个位置应该满足一定的<mark>条件(断言)</mark>。断言其实就相当于一个布尔值，只能是 0 或者 1。

由零宽度断言的定义可以看出来，它必须和和其他的表达式结合起来使用才具有意义，否则单纯的零宽度断言表达式的匹配结果就是个位置，什么字符都没有！

零宽度断言共四种：

| 符号 | 描述       |
| ---- | ---------- |
| ?=   | 正先行断言 |
| ?!   | 负先行断言 |
| ?<=  | 正后发断言 |
| ?<!  | 负后发断言 |

理解：

- 正/负：指是否满足条件(即断言)，正(负)表示(不)满足。
- 先行/后发：指的是位置(最终的匹配结果)和条件(即断言)的前后关系，先行(后发)指位置在条件前(后)。

另外，零宽度断言都要用括号扩起来。

### 正先行断言 `?=`

语法：`表达式1(?=表达式2)`

表示满足表达式1的字符串后面必须跟着满足表达式2的字符串，结果只返回满足匹配表达式1的字符串。

例如，表达式 [`(T|t)he(?=\sfat)`](https://regex101.com/r/IDDARt/1) 匹配 `The` 或者 `the`，而且 `The` 和 `the` 后面紧跟着 `空格fat`。

### 负先行断言 `?!`

语法：`表达式1(?=表达式2)`

表示满足表达式1的字符串后面必须<mark>不</mark>能跟着满足表达式2的字符串，结果只返回满足匹配表达式1的字符串。

例如，表达式 [`(T|t)he(?!\sfat)`](https://regex101.com/r/V32Npg/1) 匹配 `The` 或者 `the`，而且 `The` 和 `the` 后面<mark>不</mark>跟着 `空格fat`。

### 正后发断言 `?<=`

语法：`(?<=表达式1)表达式2`

表示满足表达式2的字符串<mark>前</mark>面面必须能跟着满足表达式1的字符串，结果只返回满足匹配表达式2的字符串。

例如，表达式 [`(?<=(T|t)he\s)(fat|mat)`](https://regex101.com/r/avH165/1) 匹配 `fat` 和 `mat`，且其前面跟着 `The空格` 或 `the空格`。

### 负后发断言 `?<!`

语法：`(?<!表达式1)表达式2`

表示满足表达式2的字符串<mark>前</mark>面面必须<mark>不</mark>能跟着满足表达式1的字符串，结果只返回满足匹配表达式2的字符串。

例如，表达式 [`(?<!(T|t)he\s)(cat)`](https://regex101.com/r/8Efx5G/1) 匹配 `cat`，且其前<mark>不</mark>跟着 `The` 或 `the`。

## 标志

标志也叫{% label info@模式修正符 %}，因为它可以用来修改表达式的搜索结果。 这些标志可以任意的组合使用，它也是整个正则表达式的一部分。

| 标志 | 描述                                                  |
| ---- | ----------------------------------------------------- |
| i    | 忽略大小写。                                          |
| g    | 全局搜索。                                            |
| m    | 多行修饰符：锚点元字符 `^` `$` 工作范围在每行的起始。 |

### 忽略大小写（Case Insensitive）

修正符 `i` 用于忽略大小写。 例如，表达式 [`/The/gi`](https://regex101.com/r/ahfiuh/1) 表示在全局搜索 `The`，在后面的 `i` 将其条件修改为忽略大小写，则变成搜索 `the` 和 `The`，`g` 表示全局搜索。

### 全局搜索（Global search）

修正符 `g` 常用于执行一个全局搜索匹配，即不仅仅返回第一个匹配的，而是返回全部。 例如，表达式 [`/.(at)/g`](https://regex101.com/r/dO1nef/1) 表示全局搜索 `非换行符以外任意单个字符` 后面跟着 `at`。

### 多行修正符（Multiline）

多行修正符 `m` 用于执行一个多行匹配。

之前介绍的 `^` 和 `$` 用于检查模式是否是在待检测字符串的开头或结尾。但我们如果想要它在<mark>每</mark>行的开头和结尾生效，我们需要用到多行修正符 `m`。

例如，表达式 [`/at(.)?$/gm`](https://regex101.com/r/E88WE2/1) 表示小写字符 `a` 后跟小写字符 `t` ，末尾再跟上一个除换行符以外的任意字符，再根据 `m` 修正符，现在表达式匹配每行的结尾。

### 贪婪匹配与惰性匹配（Greedy vs lazy matching）

正则表达式默认采用贪婪匹配模式，在该模式下意味着会匹配尽可能长的子串。我们可以使用 `?` 将贪婪匹配模式转化为惰性匹配模式。

例如 [`/(.*at)/`](https://regex101.com/r/AyAdgJ/1) 表示匹配以 `at` 结尾，前面有任意多个非换行字符的子字符串中长度最<mark>长</mark>的一个。

而 [`/(.*?at)/`](https://regex101.com/r/AyAdgJ/2) 表示匹配以 `at` 结尾，前面有任意多个非换行字符的子字符串中长度最短的一个。

## 实例

### 以某个字符串开始字符串，并且以另一个字符串结尾字符串

例如要搜索以 `https://img.alicdn.com` 开始，以 `jpg_80x80.jpg` 结束的子字符串。

```
https:\/\/img\.alicdn\.com.*jpg_80x80\.jpg
```

