---
title: 世界杯程序接口文档
date: 2018-06-06 17:55:11
categories:
tags:
password: 20180606
abstract: Interface doc for mini program at company.
message: It is useless for you.
---

[TOC]

# 原型设计

> [世界杯](http://pro.modao.cc/app/yNV6IjXGdgKjzuzbWWoCESKpAsUV3a1#screen=sACD9810F7B1527599208486)

# 建表

> [数据库](http://gz-dmc.cloud.tencent.com/v2/login)
>

## 用户表

表名：my_user

| 列名              | 类型         | 说明                                                        |
| ----------------- | ------------ | ----------------------------------------------------------- |
| id                | int(11)      | 用户自增id                                                  |
| open_id           | varchar(100) | 用户在小程序中的唯一识别id                                  |
| union_id          | varchar(100) | 用户在同一主体的多个小程序中的唯一识别id                    |
| nick_name         | varchar(50)  | 用户昵称，由于用户的昵称中可能包含表情，所以要用UTF8MB4编码 |
| head_img_url      | varchar(255) | 用户头像地址                                                |
| gender            | enum         | 性别(1：男，2：女)                                          |
| source            | tinyint      | 用户来源，从分享进来或者直接搜索等                          |
| region            | varchar      | 用户所在地区                                                |
| first_login_time  | timestamp    | 用户第一次登录的时间                                        |
| last_login_time   | timestamp    | 用户最后一次登录时间                                        |
| collection_count  | int          | 今日集球衣的次数                                            |
| collection_shirts | varchar(255) | 今日可收集的候选集合（球队名之间用"_"连接）                 |

## 海报表

表名：poster

| 列名        | 类型         | 说明                     |
| ----------- | ------------ | ------------------------ |
| id          | int          | 海报自增id               |
| template_id | int          | 模板id                   |
| team_name   | varchar(50)  | 球队名                   |
| music_url   | varchar(255) | 海报背景音乐的链接地址   |
| slogan_id   | int          | 标语id                   |
| poster_url  | varchar(255) | 生成后的海报图片链接地址 |

## 模板表

表名：template

| 列名         | 类型         | 说明                 |
| ------------ | ------------ | -------------------- |
| id           | int          | 模板自增id           |
| template_url | varchar(255) | 模板图片的链接地址   |
| music_url    | varchar(255) | 海报背景音乐链接地址 |

## 加油词表

表名：slogan

| 列名    | 类型         | 说明       |
| ------- | ------------ | ---------- |
| id      | int          | 标语自增id |
| content | varchar(100) | 标语内容   |

## ~~音乐表~~

表名：music

| 列名      | 类型         | 说明         |
| --------- | ------------ | ------------ |
| id        | int          | 音乐自增id   |
| music_url | varchar(255) | 音乐链接地址 |

## ~~球队表~~

表名：team

| 列名 | 类型        | 说明       |
| ---- | ----------- | ---------- |
| id   | int         | 球队自增id |
| name | varchar(50) | 球队名     |

## 赛程表

表名：match_schedule

| 列名       | 类型        | 说明                                        |
| ---------- | ----------- | ------------------------------------------- |
| id         | int         | 赛程自增id                                  |
| match_type | varchar(10) | 比赛类型                                    |
| group      | varchar(10) | 分组情况                                    |
| home_team  | varchar(10) | 主队                                        |
| away_team  | varchar(10) | 客队                                        |
| begin_time | timestamp   | 比赛开始时间                                |
| state      | int         | 比赛状态（0：未开始；1：已开始；2：已结束） |

## 预约表

表名：subscribe

| 列名 | 类型 | 说明   |
| ---- | ---- | ------ |
| u_id | int  | 用户id |
| m_id | int  | 赛程id |

## ~~球衣表~~

表名：polo_shirt

| 列名        | 类型        | 说明         |
| ----------- | ----------- | ------------ |
| id          | int         | 球衣自增id   |
| team_name   | varchar(50) | 所属球队名称 |
| repertory   | int         | 库存         |
| probability | double      | 概率         |
|             | String      | 注释         |

## 球衣收集记录表

表名：collection_record

| 列名        | 类型 | 说明                     |
| ----------- | ---- | ------------------------ |
| id          | int  | 集到的球衣记录id         |
| u_id        | int  | 用户id                   |
| argentina   | int  | 集到阿根廷队球衣的数量   |
| belgium     | int  | 集到比利时队球衣的数量   |
| brazil      | int  | 集到巴西队球衣的数量     |
| england     | int  | 集到英国队球衣的数量     |
| france      | int  | 集到法国队球衣的数量     |
| germany     | int  | 集到德国队球衣的数量     |
| mexico      | int  | 集到墨西哥队球衣的数量   |
| poland      | int  | 集到波兰队球衣的数量     |
| portugal    | int  | 集到葡萄牙队球衣的数量   |
| russia      | int  | 集到俄罗斯队球衣的数量   |
| serbia      | int  | 集到塞尔维亚队球衣的数量 |
| south_korea | int  | 集到韩国队球衣的数量     |
| spain       | int  | 集到西班牙队球衣的数量   |
| sweden      | int  | 集到瑞典队球衣的数量     |
| switzerland | int  | 集到瑞士队球衣的数量     |

## 球衣赠送记录表

表名：shirt_share

| 列名        | 类型        | 说明                         |
| ----------- | ----------- | ---------------------------- |
| id          | int         | 球衣分享记录id               |
| sharer_id   | int         | 分享者id                     |
| receiver_id | int         | 领取者id（-1代表没有人领取） |
| team_name   | varchar(50) | 分享的球衣所属球队名         |

## 奖品表

表名：award 

| 列名          | 类型         | 说明                                          |
| ------------- | ------------ | --------------------------------------------- |
| id            | int          | 奖品自增id                                    |
| name          | varchar(50)  | 奖品名称                                      |
| real_price    | varchar(50)  | 真实价格                                      |
| price         | double       | 标价                                          |
| award_img_url | varchar(255) | 奖品图片链接地址                              |
| award_url     | varchar(255) | 奖品详情链接地址                              |
| win_condition | varchar(255) | 获取条件（所需球衣id拼接字符串，例如：1_2_3） |
| v_repertory   | int          | 虚拟库存                                      |
| repertory     | int          | 真实库存                                      |

## 兑换记录表

表名：convert_record

| 列名       | 类型      | 说明         |
| ---------- | --------- | ------------ |
| id         | int       | 兑换记录id   |
| u_id       | int       | 中奖用户id   |
| user_name  | String    | 中奖用户名   |
| a_id       | int       | 中将奖品id   |
| award_name | String    | 中奖奖品名称 |
| win_time   | timestamp | 中奖时间     |

# 用户相关信息

## 登陆接口

### 接口概述

### URL说明

URL地址：`http://api.99yhrc.com/worldCup_test/user/login`

请求方式：POST

### 请求参数

| 参数名 | 类型   | 参数说明 |
| ------ | ------ | -------- |
| code   | String | 登陆码   |

### 返回内容

| 字段            | 类型                        | 说明                       |
| --------------- | --------------------------- | -------------------------- |
| result          | Result<Map<String, Object>> | 请求结果封装               |
| ++success       | boolean                     | 请求是否成功               |
| ++error         | String                      | 请求失败时的提示信息       |
| ++data          | Map<String, Object>         | 请求成功时返回的数据封装   |
| ++++userId      | int                         | 用户自增id                 |
| ++++loginResult | LoginResult                 | 登陆结果集封装             |
| ++++++openId    | String                      | 用户在小程序中的唯一识别id |
| ++++++sessionId | String                      | 加盐后的小程序密钥         |

## 获取用户信息

### 接口概述

### URL说明

URL地址：`http://api.99yhrc.com/worldCup_test/user/userInf`

请求方式：POST

### 请求参数

| 参数名       | 类型   | 参数说明                                                    |
| ------------ | ------ | ----------------------------------------------------------- |
| openId       | String | 微信小程序中用于唯一标识一个用户                            |
| sessionId    | String | 加盐后的小程序密钥                                          |
| uID          | int    | 用户自增id                                                  |
| nick_name    | String | 用户昵称，由于用户的昵称中可能包含表情，所以要用UTF8MB4编码 |
| head_img_url | String | 用户头像地址                                                |

### 返回内容

| 字段      | 类型                        | 说明                 |
| --------- | --------------------------- | -------------------- |
| result    | Result<Map<String, Object>> | 请求结果封装         |
| ++success | boolean                     | 请求是否成功         |
| ++error   | String                      | 请求失败时的提示信息 |

# 为喜欢的球队加油

## 生成海报

### 接口概述

根据用户选择的球队生成海报。

### URL

URL地址：`http://api.99yhrc.com/worldCup_test/poster/makePoster`

请求方式：POST

### 请求参数

| 参数名       | 类型   | 参数说明                                |
| ------------ | ------ | --------------------------------------- |
| openId       | String | 微信小程序中用于唯一标识一个用户        |
| sessionId    | String | 加盐后的小程序密钥                      |
| uID          | int    | 用户id                                  |
| teamName     | String | 球队名                                  |
| templateName | String | 使用的模板名（”template1“—"template6"） |

### 返回内容

| 字段             | 类型                        | 说明                                    |
| ---------------- | --------------------------- | --------------------------------------- |
| result           | Result<Map<String, String>> | 请求结果封装                            |
| ++success        | boolean                     | 请求是否成功                            |
| ++error          | String                      | 请求失败时的提示信息                    |
| ++data           | Map<String, String>         | 请求成功时返回的数据封装                |
| ++++posterUrl    | String                      | 海报链接                                |
| ++++templateName | String                      | 使用的模板名（”template1“—"template6"） |

# 分享集球衣

## 分享集球衣

### 接口概述

### URL说明

URL地址：`http://api.99yhrc.com/worldCup_test/collection/getPoloShirt`

请求方式：GET

### 请求参数

| 参数名 | 类型   | 参数说明                         |
| ------ | ------ | -------------------------------- |
| uID    | int    | 用户id                           |
| openId | String | 微信小程序中用于唯一标识一个用户 |

### 返回内容

| 字段    | 类型    | 说明                                     |
| ------- | ------- | ---------------------------------------- |
| success | boolean | 请求是否成功                             |
| error   | String  | 请求失败时的提示信息                     |
| data    | String  | 请求成功时返回的数据（球衣所属球队名称） |

## 集球衣记录

### 接口概述

### URL说明

URL地址：`http://localhost:8090/world_cup_test/collection/records`

请求方式：GET

### 请求参数

| 参数名    | 类型   | 参数说明                         |
| --------- | ------ | -------------------------------- |
| uID       | int    | 用户自增id                       |
| openId    | String | 微信小程序中用于唯一标识一个用户 |
| sessionId | String | 加盐后的小程序密钥               |

### 返回内容

| 字段      | 类型                      | 说明                                     |
| --------- | ------------------------- | ---------------------------------------- |
| result    | Result<List<ShirtRecord>> | 请求结果封装                             |
| ++success | boolean                   | 请求是否成功                             |
| ++error   | String                    | 请求失败时的提示信息                     |
| ++data    | List<ShirtRecord>         | 按集到的球衣数量从大到小排好序的记录列表 |

ShirtRecord说明

| 字段     | 类型   | 说明       |
| -------- | ------ | ---------- |
| teamName | String | 球队名     |
| count    | int    | 集到的数量 |



## 赠送球衣

### 接口概述

### URL说明

URL地址：`http://api.99yhrc.com/worldCup_test/poloShirt/sendShirt`

请求方式：POST

### 请求参数

| 参数名    | 类型   | 参数说明                         |
| --------- | ------ | -------------------------------- |
| uID       | int    | 用户自增id                       |
| openId    | String | 微信小程序中用于唯一标识一个用户 |
| sessionId | String | 加盐后的小程序密钥               |
| teamName  | String | 球衣所属球队的名称               |

### 返回内容

| 字段      | 类型            | 说明                 |
| --------- | --------------- | -------------------- |
| result    | Result<Integer> | 请求结果封装         |
| ++success | boolean         | 请求是否成功         |
| ++error   | String          | 请求失败时的提示信息 |
| ++data    | Integer         | 赠送记录Id           |

## 领取球衣

### 接口概述

### URL说明

URL地址：`http://api.99yhrc.com/worldCup_test/poloShirt/receiveShirt`

请求方式：POST

### 请求参数

| 参数名       | 类型   | 参数说明                         |
| ------------ | ------ | -------------------------------- |
| uID          | int    | 当前用户id                       |
| openId       | String | 微信小程序中用于唯一标识一个用户 |
| sessionId    | String | 加盐后的小程序密钥               |
| sharerId     | int    | 球衣分享者的id                   |
| teamName     | String | 球衣所属球队名                   |
| sendRecordId | int    | 赠送记录id                       |

### 返回内容

| 字段      | 类型    | 说明                 |
| --------- | ------- | -------------------- |
| result    | Result  | 请求结果封装         |
| ++success | boolean | 请求是否成功         |
| ++error   | String  | 请求失败时的提示信息 |

## 索要球衣

### 接口概述

### URL说明

URL地址：`http://api.99yhrc.com/worldCup_test/poloShirt/chargeShirt`

请求方式：POST

### 请求参数

| 参数名    | 类型   | 参数说明                         |
| --------- | ------ | -------------------------------- |
| uID       | int    | 当前用户ID                       |
| openId    | String | 微信小程序中用于唯一标识一个用户 |
| sessionId | String | 加盐后的小程序密钥               |
| chargerId | int    | 索要者的ID                       |
| teamName  | String | 球衣所属球队名称                 |

### 返回内容

| 字段      | 类型                        | 说明                 |
| --------- | --------------------------- | -------------------- |
| result    | Result<Map<String, Object>> | 请求结果封装         |
| ++success | boolean                     | 请求是否成功         |
| ++error   | String                      | 请求失败时的提示信息 |

## 活动奖品

### 接口概述

### URL说明

URL地址：`http://api.99yhrc.com/worldCup_test/collection/awards`

请求方式：GET

### 请求参数

无

### 返回内容

| 字段             | 类型                | 说明                     |
| ---------------- | ------------------- | ------------------------ |
| result           | Result<List<Award>> | 请求结果封装             |
| ++success        | boolean             | 请求是否成功             |
| ++error          | String              | 请求失败时的提示信息     |
| ++data           | List<Award>         | 请求成功时返回的数据封装 |
| ++++name         | String              | 奖品名称                 |
| ++++price        | double              | 标价                     |
| ++++awardUrl     | String              | 奖品链接地址             |
| ++++winCondition | String              | 获取条件                 |

# 赛程数据

> [世界杯数据中心](http://data.2018.163.com/)

# 接口模板

## 接口名

### 接口概述

### URL说明

URL地址：`http://api.99yhrc.com/worldCup_test/`

请求方式：GET/POST

### 请求参数

| 参数名    | 类型   | 参数说明                         |
| --------- | ------ | -------------------------------- |
| openId    | String | 微信小程序中用于唯一标识一个用户 |
| sessionId | String | 加盐后的小程序密钥               |

### 返回内容

| 字段      | 类型                        | 说明                     |
| --------- | --------------------------- | ------------------------ |
| result    | Result<Map<String, Object>> | 请求结果封装             |
| ++success | boolean                     | 请求是否成功             |
| ++error   | String                      | 请求失败时的提示信息     |
| ++data    | Map<String, Object>         | 请求成功时返回的数据封装 |

